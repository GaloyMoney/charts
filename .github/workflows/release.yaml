name: Chart Release Smoketest
on:
  push: 
    branches:
      - ci-chart-release-public-test

jobs:
  release_test:
    name: Run Latest Images
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Start minikube
        uses: medyagh/setup-minikube@master
      - run: helm repo add galoy https://galoymoney.github.io/charts
      
      - name: Bitcoind
        run: |
          helm install bitcoind galoy/bitcoind
          kubectl wait pods -n default --for=condition=Ready -l app.kubernetes.io/name=bitcoind

      - name: LND
        run: |
          helm install lnd galoy/lnd
          kubectl wait pods -n default --for=condition=Ready -l app.kubernetes.io/name=lnd --timeout=5m

      # - run: helm install galoy galoy/galoy
      # - run: helm install galoy-pay galoy/galoy-pay
      # - run: helm install dealer galoy/dealer
      # - run: helm install admin-panel galoy/admin-panel
      # - run: helm install monitoring galoy/monitoring
      # - run: helm install rtl galoy/rtl
      # - run: helm install specter galoy/specter
      # - run: helm install web-wallet galoy/web-wallet
