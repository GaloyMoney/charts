apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-lnd-from-api
  namespace: {{ .Values.lndNamespace }}
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: lnd
  policyTypes:
  - Ingress
  ingress:
    - from:
      {{- range $.Values.deployment }}
      - podSelector:
          matchLabels:
            app: {{ .name }}
        namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: {{ $.Release.Namespace }}
      {{- end }}
      - podSelector:
          matchLabels:
            app: cronjob
        namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: {{ $.Release.Namespace }}
      ports:
       - port: 10009
    
