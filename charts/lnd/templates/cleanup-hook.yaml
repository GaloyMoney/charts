{{- if ne .Values.global.network "regtest" }}
apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "lnd.fullname" . }}-cleanup"
  annotations:
    "helm.sh/hook": "pre-delete"
    "helm.sh/hook-delete-policy": hook-succeeded
spec:
  securityContext:
    runAsUser: 0
  serviceAccountName: {{ include "lnd.serviceAccountName" . }}
  containers:
  - name: delete-configmaps
    image: "boxboat/kubectl"
    imagePullPolicy: IfNotPresent
    command: ['/bin/sh']
    args: ['-c','kubectl delete configmap {{ include "lnd.fullname" . }}-tls {{ include "lnd.fullname" . }}-macaroon --ignore-not-found=true']
{{- end }}
